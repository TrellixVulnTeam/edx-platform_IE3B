// Generated by CoffeeScript 1.6.1

/*
E-Commerce Section
*/


(function() {
  var ECommerce;

  ECommerce = (function() {
    var isInt;

    function ECommerce($section) {
      var _this = this;
      this.$section = $section;
      this.$section.data('wrapper', this);
      this.$list_purchase_csv_btn = this.$section.find("input[name='list-purchase-transaction-csv']'");
      this.$transaction_group_name = this.$section.find("input[name='transaction_group_name']'");
      this.$course_registration_number = this.$section.find("input[name='course_registration_code_number']'");
      this.$download_transaction_group_name = this.$section.find("input[name='download_transaction_group_name']'");
      this.$active_transaction_group_name = this.$section.find("input[name='active_transaction_group_name']'");
      this.$spent_transaction_group_name = this.$section.find('input[name="spent_transaction_group_name"]');
      this.$generate_registration_code_form = this.$section.find("form#course_codes_number");
      this.$download_registration_codes_form = this.$section.find("form#download_registration_codes");
      this.$active_registration_codes_form = this.$section.find("form#active_registration_codes");
      this.$spent_registration_codes_form = this.$section.find("form#spent_registration_codes");
      this.$coupoon_error = this.$section.find('#coupon-error');
      this.$course_code_error = this.$section.find('#code-error');
      this.$list_purchase_csv_btn.click(function(e) {
        var url;
        url = _this.$list_purchase_csv_btn.data('endpoint');
        url += '/csv';
        return location.href = url;
      });
      this.$download_registration_codes_form.submit(function(e) {
        _this.$course_code_error.attr('style', 'display: none');
        _this.$coupoon_error.attr('style', 'display: none');
        return true;
      });
      this.$active_registration_codes_form.submit(function(e) {
        _this.$course_code_error.attr('style', 'display: none');
        _this.$coupoon_error.attr('style', 'display: none');
        return true;
      });
      this.$spent_registration_codes_form.submit(function(e) {
        _this.$course_code_error.attr('style', 'display: none');
        _this.$coupoon_error.attr('style', 'display: none');
        return true;
      });
      this.$generate_registration_code_form.submit(function(e) {
        var group_name, registration_codes;
        _this.$course_code_error.attr('style', 'display: none');
        _this.$coupoon_error.attr('style', 'display: none');
        group_name = _this.$transaction_group_name.val();
        if (group_name === '') {
          _this.$course_code_error.html('Please Enter the Transaction Group Name').show();
          return false;
        }
        if ($.isNumeric(group_name)) {
          _this.$course_code_error.html('Please Enter the non-numeric value for Transaction Group Name').show();
          return false;
        }
        registration_codes = _this.$course_registration_number.val();
        if (isInt(registration_codes) && $.isNumeric(registration_codes)) {
          if (parseInt(registration_codes) > 1000) {
            _this.$course_code_error.html('You can only generate 1000 Registration Codes at a time').show();
            return false;
          }
          if (parseInt(registration_codes) === 0) {
            _this.$course_code_error.html('Please Enter the Value greater than 0 for Registration Codes').show();
            return false;
          }
          return true;
        } else {
          _this.$course_code_error.html('Please Enter the Integer Value for Registration Codes').show();
          return false;
        }
      });
    }

    ECommerce.prototype.onClickTitle = function() {
      return this.clear_display();
    };

    ECommerce.prototype.onClickTitle = function() {
      return this.clear_display();
    };

    ECommerce.prototype.onExit = function() {
      return this.clear_display();
    };

    ECommerce.prototype.clear_display = function() {
      this.$course_code_error.attr('style', 'display: none');
      this.$coupoon_error.attr('style', 'display: none');
      this.$course_registration_number.val('');
      this.$transaction_group_name.val('');
      this.$download_transaction_group_name.val('');
      this.$active_transaction_group_name.val('');
      return this.$spent_transaction_group_name.val('');
    };

    isInt = function(n) {
      return n % 1 === 0;
    };

    return ECommerce;

  })();

  _.defaults(window, {
    InstructorDashboard: {}
  });

  _.defaults(window.InstructorDashboard, {
    sections: {}
  });

  _.defaults(window.InstructorDashboard.sections, {
    ECommerce: ECommerce
  });

}).call(this);
